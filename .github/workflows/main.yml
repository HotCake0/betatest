name: Update Live Status

on:
  schedule:
    - cron: '*/5 * * * *' # 10분마다 실행 (깃허브 무료 정책상 5~10분 딜레이가 있을 수 있음)
  workflow_dispatch: # 수동으로 버튼 눌러서 실행 가능하게 함

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: 저장소 체크아웃
        uses: actions/checkout@v3

      - name: 파이썬 설정
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: 필요한 라이브러리 설치
        run: |
          pip install requests

      - name: 파이썬 스크립트 실행 (데이터 갱신)
        run: |
          python update_status.py

      - name: 변경사항 저장 및 커밋 (봇이 수행)
        run: |
          git config --global user.name 'GitHub Action Bot'
          git config --global user.email 'action@github.com'
          git add status.json
          git diff --quiet && git diff --staged --quiet || (git commit -m "Update live status" && git push)
